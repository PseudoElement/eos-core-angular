<div class="base-param-wrapper" *ngIf="!isLoading">
    <eos-user-params-header [editMode]="editMode" [title]='title' [disableBtn]="!getValidDate || newInfo" (submitEmit)='submit($event)' (cancelEmit)='cancel($event)' (editEmit)='edit($event)'></eos-user-params-header>
    <div class="base-param-main">
        <div class="top-base-align">
            <div class="avatar-base" *ngIf="curentUser.DUE_DEP else tech">
                <a class="av-link-b" [routerLink]="['/spravochniki','departments', curentUser.DUE_DEP, 'view' ]">
                    <span class="avatar-img-b" *ngIf="isPhoto" [ngStyle]="{'background-image': urlPhoto}"></span>
                    <span class="avatar-img-b" *ngIf="!isPhoto" class="avatar-img-b eos-icon eos-icon-Man-Blue small"></span>
                </a>
            </div>
            <ng-template #tech>
                <div class="avatar-base">
                    <a class="av-link-b">
                        <span class="avatar-img-b" class="avatar-img-b eos-icon eos-icon-Techman-Blue small"></span>
                    </a>
                </div>
            </ng-template>
            <!-- Логин и Аутентификация с помощью ОС -->
            <div class="wrapper-password">
                <div style="width: 200px" class="base-text-input base-login-input" [formGroup]="form" [tooltip]="!curentUser['IS_PASSWORD'] && editMode ? 'Для смены логина задайте пароль' : validClassif" container="body" placement="bottom" containerClass="tooltip-error">
                    <label  [hidden]="inputs['CLASSIF_NAME'].hideLabel" [attr.for]="inputs['CLASSIF_NAME'].key">{{inputs['CLASSIF_NAME'].label}}</label >
                    <input class="form-control m-font" maxlength="12" [formControlName]="inputs['CLASSIF_NAME'].key" [readonly]="inputs['CLASSIF_NAME'].readonly" autocomplete="off">
                </div>
                <div style="width: 315px" class="mar-fio-r" [formGroup]="form" [tooltip]="!form.controls['SURNAME_PATRON'].value ? 'Поле ФАМИЛИЯ И.О. не может быть пустым' : null"
                container="body" placement="bottom" containerClass="tooltip-error">
                    <label [hidden]="inputs['SURNAME_PATRON'].hideLabel" [attr.for]="inputs['SURNAME_PATRON'].key">{{inputs['SURNAME_PATRON'].label}}</label>
                    <input  class="form-control m-font" maxlength="64" [formControlName]="inputs['SURNAME_PATRON'].key" [readonly]="inputs['SURNAME_PATRON'].readonly" autocomplete="off">
                </div>
            </div>
        </div>
        <!-- технический пользователь -->
        <eos-dynamic-input class="base-login-input" [input]="controls['teсhUser']" [form]="formControls" tooltip="Технический пользователь" placement="bottom" containerClass="tooltip-info"></eos-dynamic-input>
        <!-- должностное лицо и роль -->
        <div class="base-login-input row-department-role">
            <div [formGroup]="form" class="dynamic-input-wrapper inline-block base-department-input">
                <label [attr.for]="inputs['DUE_DEP_NAME'].key">{{inputs['DUE_DEP_NAME'].label}}</label>
                <div [ngClass]="{'required': inputs['DUE_DEP_NAME'].required, 'department-role-flex': true}" style="width: 550px">
                    <input class="form-control m-font inline-block" readonly [formControlName]="inputs['DUE_DEP_NAME'].key" [id]="inputs['DUE_DEP_NAME'].key" type="text" [ngClass]="{'readonly': readonly}" [placeholder]="inputs['DUE_DEP_NAME'].label" autocomplete="off">
                    <span class="icon eos-icon small icon-add-department span-avatar-icon" [ngClass]="{'eos-icon-avatar-blue': !curentUser.isTechUser && editMode, 'eos-icon-avatar-grey': curentUser.isTechUser || !editMode}" (click)="selectDepartment(form.get('DUE_DEP_NAME').enabled)"></span>
                </div>
            </div>
        </div>
        <eos-dynamic-input class="base-text-input base-input-role"
                [input]="controls['SELECT_ROLE']"
                [form]="formControls"
                [container]="body"
                [readonly]="curentUser.isTechUser || !editMode"
                [disabled] = "curentUser.isTechUser || formControls.controls['SELECT_ROLE'].disabled"></eos-dynamic-input><br>
        <!-- Доступ к системам 1-й ряд -->
        <span class="l-font">Доступ к системам</span>
        <hr>
        <div>
            <eos-dynamic-input [input]="accessInputs['0']" [form]="formAccess" [readonly]="formAccess.get('0').disabled" class="base-checkbox-input"  (change)="[tf(), checkMeinControlAccess($event, '0')]"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['0-1']" [form]="formAccess" [readonly]="formAccess.get('0-1').disabled" class="base-checkbox-input" (change)="[tf(), checkMeinControlAccess($event, '0-1')]"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['delo_web']" [form]="formAccess" [readonly]="formAccess.get('delo_web').disabled" (change)="[tf(), checkMeinControlAccess($event, 'delo_web')]"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['1-27']" [form]="formAccess" [readonly]="formAccess.get('1-27').disabled" class="pull-right"></eos-dynamic-input>
        </div>
        <hr style="margin-top: 5px;">
        <!-- Доступ к системам 2-й ряд -->
      <div class="access-syst-wr">
        <div class="access-syst-part">
            <eos-dynamic-input [input]="accessInputs['26']" [form]="formAccess" [readonly]="formAccess.get('26').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['23']" [form]="formAccess" [readonly]="formAccess.get('23').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['25']" [form]="formAccess" [readonly]="formAccess.get('25').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['21']" [form]="formAccess" [readonly]="formAccess.get('21').disabled"></eos-dynamic-input>
        </div>
        <!-- Доступ к системам 3-й ряд -->
        <div class="access-syst-part">
            <eos-dynamic-input [input]="accessInputs['2']" [form]="formAccess" [readonly]="formAccess.get('2').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['3']" [form]="formAccess" [readonly]="formAccess.get('3').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['15']" [form]="formAccess" [readonly]="formAccess.get('15').disabled" class="base-checkbox-input"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['17']" [form]="formAccess" [readonly]="formAccess.get('17').disabled"></eos-dynamic-input>
        </div>
        <!-- Доступ к системам 4-й ряд -->
        <div class="access-syst-part">
            <eos-dynamic-input [input]="accessInputs['16']" [form]="formAccess" [readonly]="formAccess.get('16').disabled"></eos-dynamic-input>
            <eos-dynamic-input [input]="accessInputs['5']" [form]="formAccess" [readonly]="formAccess.get('5').disabled"></eos-dynamic-input>
            <span (click)="getSerts(template)" class="eos-icon small icon-electronic" [ngClass]="{'eos-icon-electronic-signature-blue pointer': editMode, 'eos-icon-electronic-signature-grey': !editMode}" [tooltip]="editMode ? 'Выбор сертификатов пользователя' : null"
            placement="bottom" containerClass="tooltip-info"></span>
        </div>
      </div>
      <hr style="margin-top: 5px;">
      <div [formGroup]="formControls" class="dynamic-input-wrapper inline-block base-department-input">
        <label [attr.for]="controls['USER_COPY'].key">{{controls['USER_COPY'].label}}</label>
        <div class="create-user-wr">
            <input class="form-control m-font inline-block" (keyup)="delSelectUser($event)" readonly [formControlName]="controls['USER_COPY'].key" [id]="controls['USER_COPY'].key" type="text" [placeholder]="controls['USER_COPY'].label" autocomplete="off">
            <span class="icon eos-icon small icon-add-department" [ngClass]="{'eos-icon-avatar-blue': editMode, 'eos-icon-avatar-grey': !editMode}" (click)="selectUser()"></span>
        </div>
      </div>
      <div class="access-syst-wr settings-copy-top">
        <div class="access-syst-part">
            <eos-dynamic-input [input]="settingsCopyInputs['copy_0']" [form]="formSettingsCopy" class="base-checkbox-input" [readonly]="formSettingsCopy.get('copy_0').disabled"></eos-dynamic-input>
            <eos-dynamic-input [input]="settingsCopyInputs['copy_3']" [form]="formSettingsCopy" class="base-checkbox-input" [readonly]="formSettingsCopy.get('copy_3').disabled"></eos-dynamic-input>
        </div>
        <div class="access-syst-part">
            <eos-dynamic-input [input]="settingsCopyInputs['copy_1']" [form]="formSettingsCopy" class="base-checkbox-input" [readonly]="formSettingsCopy.get('copy_1').disabled"></eos-dynamic-input>
            <eos-dynamic-input style="white-space: pre;" [input]="settingsCopyInputs['copy_4']" [form]="formSettingsCopy" class="base-checkbox-input" [readonly]="formSettingsCopy.get('copy_4').disabled"></eos-dynamic-input>
        </div>
        <div class="access-syst-part">
            <eos-dynamic-input [input]="settingsCopyInputs['copy_2']" [form]="formSettingsCopy" class="base-checkbox-input" [readonly]="formSettingsCopy.get('copy_2').disabled"></eos-dynamic-input>
        </div>
      </div>
    <!-- Примечания -->
    <div>
        <eos-dynamic-input class="note-textarea" onkeypress="return event.keyCode != 13;" [input]="inputs['NOTE2']" [form]="form" [readonly]="inputs['NOTE2'].readonly" style="width: 100%"></eos-dynamic-input>
    </div>
    </div>
</div>


<div class="base-param-wrapper">
    <div class="spinner-wrapper" *ngIf="isLoading">
        <eos-spinner [size]="'lg'"></eos-spinner>
    </div>
</div>

<div *ngIf="isShell" class="shell"></div>

<ng-template #template>
    <eos-base-serts (closeModal)="closeSerts()"></eos-base-serts>
</ng-template>
