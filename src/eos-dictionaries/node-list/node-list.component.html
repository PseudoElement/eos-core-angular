<div class="table-wrapper usual-border" id="sizeholder">
    <div class="table-header">
            <!-- (window:resize)="onResize($event)" -->
        <div class="table-header-content"
             [ngStyle]="{'width.%': 100, 'left.px': headerOffset}">
            <div *ngIf="params.markItems"
                 class="checkbox-inline">
                <label [ngClass]="{'group-checkbox': anyUnmarked && anyMarked}"
                       [tooltip]="markAllTooltip"
                       placement="bottom"
                       container="body"
                       [delay]="tooltipDelay"
                       containerClass="tooltip-info">
                    <input type="checkbox" [(ngModel)]="allMarked" (change)="toggleAllMarks()">
                    <span></span>
                </label>
            </div>
            <div *ngIf="!params.markItems"
                 class="node-left">
            </div>
            <div class="node-title">
                <div *ngFor="let field of viewFields"
                     class="item l-font"
                     [attr.id]="'vf_'+field.key"
                     [ngStyle]="{'min-width.px': min_length[field.key]}">
                    <span class="text selected-text ng-bind-html"
                          (click)="orderByField(field.key)">{{untrimmedValue(field.customTitle || field.title)}}</span>
                    <span class="order-icon">
                        <span *ngIf="orderBy?.fieldKey === field.key"
                              class="icon eos-icon small"
                              [ngClass]="{'eos-icon-arrow-blue-top': orderBy?.ascend, 'eos-icon-arrow-blue-bottom': !orderBy?.ascend}"></span></span></div>

                <div *ngIf="firstColumnIndex > 0" class="arrow-left selected-text" (click)="onLeftClick()">
                    <div class="arrow-left-fix">
                    <i class="fa fa-angle-left "></i>
                    </div>
                </div>
                <div *ngFor="let field of getSlicedCustomFields();let first=first;"
                     class="item l-font"
                     [class.left-shadowed]="first && (firstColumnIndex > 0)"
                     [attr.id]="'vf_'+field.key"
                    [ngStyle]="{'min-width.px': min_length[field.key]}">
                    <span class="text selected-text"
                          (click)="orderByField(field.key)">{{untrimmedValue(field.customTitle || field.title)}}</span><span class="order-icon">
                    <span *ngIf="orderBy?.fieldKey === field.key"
                          class="eos-icon small"
                          [ngClass]="{'eos-icon-arrow-blue-top': orderBy?.ascend, 'eos-icon-arrow-blue-bottom': !orderBy?.ascend}"></span></span></div>
            </div>
            <div *ngIf="hasOverflowedColumns" class="arrow-right selected-text" (click)="onRightClick()">
                <i class="fa fa-angle-right "></i>
            </div>
        </div>
    </div>
    <div class="eos-node-list"
        #eosNodeList
        (scroll)="onListScroll($event)">
        <div class="block list"
             [ngStyle]="{'width.%': 100}">
            <p *ngIf="params.updatingList || !recalcDone"
               class="spinner-container text-center">
                <eos-spinner size="lg"></eos-spinner>
            </p>
            <p *ngIf="!nodes?.length && !params.updatingList"
               class="text-center text-info node-list-info">Нет записей.</p>
            <!--Sortable list-->
            <ng-container *ngIf="params.userOrdered && nodes?.length && !params.searchResults && !params.updatingList && recalcDone">
                <bs-sortable [(ngModel)]="nodes"
                             [itemTemplate]="childTemplate"
                             itemClass="{'highlighted': node.isSelected}"
                             itemActiveClass="sortable-item-active"
                             placeholderItem="Drag here"
                             (drop)="toggleItem()"
                             placeholderClass="placeholderStyle"
                             wrapperClass="sortable-wrapper">
                </bs-sortable>
            </ng-container>
            <!--Simple list-->
            <ng-container *ngIf="!params.userOrdered && nodes?.length && !params.updatingList && recalcDone || params.searchResults && !params.updatingList && recalcDone">
                <eos-node-list-item *ngFor="let item of nodes"
                                    [ngStyle]="{'width.%': 100}"
                                    [length]="length"
                                    [node]="item"
                                    [params]="params"
                                    [customFields]="customFields"
                                    [firstColumnIndex]="firstColumnIndex"
                                    (clickSelect)="onClickSelect(item)"
                                    (clickMark)="onClickMark(item,$event)"
                                    >
                                    </eos-node-list-item>
            </ng-container>
        </div>
    </div>
</div>
<ng-template #markAllTooltip>
    {{anyMarked ? 'Снять' : 'Пометить'}}<br/>{{anyMarked ? 'пометки': 'все'}}
</ng-template>

<ng-template #childTemplate
             let-item="item"
             let-index="index">
    <eos-node-list-item [node]="item.value"
                        [length]="length"
                        [params]="params"
                        [customFields]="customFields"
                        [firstColumnIndex]="firstColumnIndex"
                        (clickSelect)="onClickSelect(item.value,$event)"
                        (clickMark)="onClickMark(item.value,$event)"
                        ></eos-node-list-item>
</ng-template>
